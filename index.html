
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Moxley Stratton</title>
  <meta name="author" content="Moxley Stratton">

  
  <meta name="description" content="I&rsquo;ve installed the following Atom plugins for Elixir: language-elixir
linter-elixirc
linter-elixir-credo
atom-elixir-formatter After installing &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.moxleystratton.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Moxley Stratton" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4516172-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Moxley Stratton</a></h1>
  
    <h2>Code Blog</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.moxleystratton.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/02/05/atom-elixir-setup/">Atom Editor Setup for Elixir</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-02-05T09:02:41-08:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>9:02 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve installed the following Atom plugins for Elixir:</p>

<ul>
<li>language-elixir</li>
<li>linter-elixirc</li>
<li>linter-elixir-credo</li>
<li>atom-elixir-formatter</li>
</ul>


<p>After installing each of these packages, make sure you configure them. Most of
them don&rsquo;t work without explicit configuration.</p>

<p>Most of these plugins require you to configure either the <code>elixir</code> binary path
or the <code>mix</code> binary path (or both). To do so, first open a terminal, and run
<code>which elixir</code> or <code>which mix</code> to get the binary path.</p>

<h2>language-elixir</h2>

<p>This is the minimal package you want to use when developing Elixir code.
It provides code syntax highlighting.</p>

<h2>linter-elixirc</h2>

<p>This provides feedback when you write bad syntax or syntax that is considered a
warning by the Elixir compiler. It saves time that would be wasted running
tests, only to find out you wrote bad syntax.</p>

<h2>linter-elixir-credo</h2>

<p>This provides feedback when you write syntax that violates code style conventions
managed by Credo.</p>

<h2>atom-elixir-formatter</h2>

<p>Utility that formats Elixir code with the Elixir Formatter. One side utility of
this package is that it allows you to paste in large data structures from test
output into your test or fixtures, then easily format the resulting code. It
only works if you have Elixir 1.6 or higher.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/28/elixir-abstract-syntax/">Elixir Abstract Syntax</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-12-28T09:02:41-08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>9:02 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As developers know, program source code is represented as lines of text.</p>

<p>The <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">Abstract Syntax Tree
(AST)</a> is the representation
of the source code as a hierarchical data graph, specifically a tree structure.
With an AST, much of the difficult work parsing the original source code has
been performed, and the syntax can be introspected programatically.</p>

<p>Similar to an AST, the <a href="https://en.wikipedia.org/wiki/Abstract_semantic_graph">Abstract Semantic Graph (ASG)</a> is a graph of the
semantic representation of the source code. The ASG goes one step further than
the AST by representing semantic information.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2017/12/28/elixir-abstract-syntax/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/08/09/install-redis-on-macos-with-homebrew/">Install Redis on macOS With Homebrew</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-08-09T10:02:41-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>10:02 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Install</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew update
</span><span class='line'>brew install redis</span></code></pre></td></tr></table></div></figure>


<h2>Upgrade</h2>

<p>If Redis is already installed, you might want to upgrade:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew upgrade redis</span></code></pre></td></tr></table></div></figure>


<h2>Verify</h2>

<p>Check to see if Redis is already running:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>redis-cli</span></code></pre></td></tr></table></div></figure>


<p>If it&rsquo;s already running, you can probably stop here.</p>

<h2>Launch on System Boot</h2>

<p>Check to see if it is already set up to launch on boot:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls -l ~/Library/LaunchAgents | grep -i redis</span></code></pre></td></tr></table></div></figure>


<p>Make it launch on boot:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ln -sfv /usr/local/opt/redis/*.plist ~/Library/LaunchAgents</span></code></pre></td></tr></table></div></figure>


<h2>Management</h2>

<p>Redis can be started and stopped with these two commands:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew services start redis
</span><span class='line'>brew services stop redis</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/08/09/install-elixir-on-macos-using-asdf/">Install Elixir on macOS Using ASDF</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-08-09T09:45:01-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>9:45 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Install asdf</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.3.0
</span><span class='line'>echo -e '\n. $HOME/.asdf/asdf.sh' &gt;&gt; ~/.bash_profile
</span><span class='line'>echo -e '\n. $HOME/.asdf/completions/asdf.bash' &gt;&gt; ~/.bash_profile
</span><span class='line'>. ~/.bash_profile</span></code></pre></td></tr></table></div></figure>


<h2>Install Erlang and Elixir Plugins</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>asdf plugin-add erlang https://github.com/asdf-vm/asdf-erlang.git
</span><span class='line'>asdf plugin-add elixir https://github.com/asdf-vm/asdf-elixir.git</span></code></pre></td></tr></table></div></figure>


<h2>Uninstall Erlang and Elixir managed by Brew</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew uninstall --force erlang
</span><span class='line'>brew uninstall --force elixir</span></code></pre></td></tr></table></div></figure>


<h2>Install Erlang</h2>

<p>Check what versions of Erlang are available:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>asdf list-all erlang</span></code></pre></td></tr></table></div></figure>


<p>Install and Use Erlang:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>asdf install erlang 19.3
</span><span class='line'>asdf global erlang 19.3</span></code></pre></td></tr></table></div></figure>


<h2>Install Elixir</h2>

<p>Check what versions of Elixir are available:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>asdf list-all elixir</span></code></pre></td></tr></table></div></figure>


<p>Install and Use Elixir:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>asdf install elixir 1.4.4
</span><span class='line'>asdf global elixir 1.4.4</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/27/low-level-activerecord/">Low-Level ActiveRecord</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-27T10:58:40-07:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:58 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>With many Rails projects, there is occasionally a need to bypass the normal
ActiveRecord API, and get closer to the low-level SQL API. Here are a few
useful methods that bypass the confines of everyday ActiveRecord.</p>

<h3>#find_by_sql</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find_by_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE id = 1&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This returns model instances for the given SQL string.</p>

<p><code>#find_by_sql</code> also accepts parametrized values, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find_by_sql</span><span class="p">(</span><span class="o">[</span><span class="s2">&quot;SELECT * FROM users WHERE id = ?&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>#select_all</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">  SELECT id, first_name, created_at</span>
</span><span class='line'><span class="s2">  FROM users</span>
</span><span class='line'><span class="s2">  WHERE id = 1&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">users</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;id&quot;</span>         <span class="o">=&gt;</span> <span class="mi">202</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;first_name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Trystan&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;created_at&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;2015-09-05 15:44:51.597326&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This returns an array-like object of type <code>ActiveRecord::Result</code>. Each item in
the collection is a <code>Hash</code> representing a row in the results.</p>

<p>The <code>ActiveRecord::Result</code> contains information about the table and its columns.
It knows how to convert column values to <em>some of</em> their corresponding Ruby
types.</p>

<h3>#execute</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT id, first_name, created_at FROM users WHERE id=1&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">users</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;id&quot;</span>         <span class="o">=&gt;</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;first_name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Trystan&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;created_at&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;2015-09-05 15:44:51.597326&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This returns an array-like object that is specific on the database driver. For
PostgreSQL, this will be a <code>PG::Result</code>. Each item in the collection is a
<code>Hash</code>. The values of the Hash are strings and nils. No conversion is performed
to convert the values to the appropriate Ruby type, other than NULL to nil.</p>

<h3>#quote</h3>

<p>The <code>select_all</code> and <code>execute</code> methods have no built-in mechanism for escaping
values for the SQL statement.</p>

<p>Something like this is bad practice:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">  SELECT * FROM users WHERE email=&#39;</span><span class="si">#{</span><span class="n">email</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Because we&rsquo;re not sure what is in <code>email</code>. It could have an SQL injection
attack, or it could just have unexpected characters that will break
the query. To cover these
cases, ActiveRecord provides <code>#quote</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">conn</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span>
</span><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">  SELECT * FROM users WHERE email=</span><span class="si">#{</span><span class="n">conn</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that the SQL statement does not have single quote marks around the email.
<code>#quote</code> does that automatically.</p>

<h3>#sanitize_sql_array</h3>

<p>Using <code>#quote</code> can get unwieldy as more and more values need to be escaped.
There is a private method called <code>#sanitize_sql_array</code> that brings back the
parameterized escape mechanism that is present in ActiveRecord&rsquo;s higher-level
API.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">sql</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="ss">:sanitize_sql_array</span><span class="p">,</span>
</span><span class='line'>  <span class="o">[</span><span class="s2">&quot;SELECT * FROM users WHERE email=?&quot;</span><span class="p">,</span> <span class="n">email</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">users</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>#connection_config</h3>

<p>Sometimes you need to introspect the database connection details. Maybe you have an external utility that performs bulk operations against the database, and
it bypasses ActiveRecord entirely.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span> <span class="o">=</span> <span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">database_configuration</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;common&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;adapter&quot;</span>           <span class="o">=&gt;</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;encoding&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;utf8&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;postgis_extension&quot;</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;username&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;password&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;host&quot;</span>              <span class="o">=&gt;</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;port&quot;</span>              <span class="o">=&gt;</span> <span class="mi">5432</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s2">&quot;development&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;adapter&quot;</span>           <span class="o">=&gt;</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;encoding&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;utf8&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;postgis_extension&quot;</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;username&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;password&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;host&quot;</span>              <span class="o">=&gt;</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;port&quot;</span>              <span class="o">=&gt;</span> <span class="mi">5432</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;database&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;database_development&quot;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s2">&quot;production&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;adapter&quot;</span>           <span class="o">=&gt;</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;encoding&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;utf8&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;postgis_extension&quot;</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;username&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;password&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;host&quot;</span>              <span class="o">=&gt;</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;port&quot;</span>              <span class="o">=&gt;</span> <span class="mi">5432</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;database&quot;</span>          <span class="o">=&gt;</span> <span class="s2">&quot;database_production&quot;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>#with_connection</h2>

<p>Using a database connection and not returning is like opening a file and not
closing it. It can lead to connection leaks in some contexts.
ActiveRecord provides a block-style pattern for using a database connection:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection_pool</span><span class="o">.</span><span class="n">with_connection</span> <span class="k">do</span> <span class="o">|</span><span class="n">conn</span><span class="o">|</span>
</span><span class='line'>  <span class="n">users</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">    SELECT * FROM users WHERE email=</span><span class="si">#{</span><span class="n">conn</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>#structure_load</h2>

<p>For times when you need to load a bunch of SQL statements from a file,
ActiveRecord provides <code>#structure_load</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span> <span class="o">=</span> <span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">database_configuration</span><span class="o">[</span><span class="s1">&#39;development&#39;</span><span class="o">]</span>
</span><span class='line'><span class="n">sql_file</span> <span class="o">=</span> <span class="s2">&quot;tmp/foo.sql&quot;</span>
</span><span class='line'><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Tasks</span><span class="o">::</span><span class="no">DatabaseTasks</span><span class="o">.</span><span class="n">structure_load</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">sql_file</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/29/switching-to-octopress-from-wordpress/">Switching to Octopress From Wordpress</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-29T11:34:20-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:34 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="http://cl.ly/image/1k3O2Y023s1u/octopress-atom.jpg" title="Octopress and Atom - A potent combination" alt="octopress post in atom" /></p>

<p>Wordpress has been my blogging platform for the last two years, and
Drupal for a few years before that. Both are written in PHP and both
were installed and maintained on a traditional shared hosting account.
I would have stuck with Wordpress if it weren&rsquo;t for it&rsquo;s lack of robust
Markdown language support. Writing a coder&rsquo;s blog requires code samples,
usually in multiple languages. Github&rsquo;s flavor of Markdown has proved to be
an excellent language for authoring content that includes code samples, and
Octopress supports it by default.</p>

<p><a href="http://octopress.org/">Octopress</a>
is a wrapper around <a href="http://jekyllrb.com/">Jekyll</a>, and Jekyll is well suited for
publishing a blog to a Github&rsquo;s Pages service. Since Jekyll only generates a
static site, it can be much faster than a PHP solution like Wordpress or Drupal.
When used in conjunction with the <a href="https://atom.io/">Atom text editor</a>,
Octopress becomes a powerful blogging platform.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/24/sometimes-clojure-is-more-concise-than-ruby/">Sometimes Clojure Is More Concise Than Ruby</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-24T19:00:00-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>7:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I find that 90% of the time, Clojure is more verbose than Ruby. Here&rsquo;s one simple example where Clojure wins a conciseness battle:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="c1">;; Subtract two vectors in Clojure</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">a</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">9</span> <span class="mi">8</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">b</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="nb">map - </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
</span><span class='line'><span class="c1">;; (9 7 5)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Subtract two vectors in Ruby</span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="o">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="o">]</span>
</span><span class='line'><span class="n">b</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">]</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">|</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="p">}</span>
</span><span class='line'><span class="c1"># [9, 7, 5]</span>
</span></code></pre></td></tr></table></div></figure>


<p>What is it about Ruby that makes it less concise in this example?</p>

<p>In my opinion, the OOP nature of Ruby gets in the way. In OOP, there is a message receiver
(the object), plus zero or more arguments. In Clojure, there is no receiver, only arguments.
In Ruby, the two arguments to Clojure&rsquo;s <code>map</code> call have to be split up into the receiver
and the first argument. Additionally, the arguments to Ruby&rsquo;s <code>map</code> arrive as a single
array instead of of two distinct scalar arguments. This requires the destructor
parentheses inside the <code>map</code> block.</p>

<p>The syntactical division between a receiver and it&rsquo;s arguments is usually not a problem.
But every once in a while, it gets in the way. Another division in OOP is between class
and instance. I&rsquo;ve found that this division can sometimes get in the way too.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/29/finding-the-source-for-a-given-rails-web-page/">Finding the Source for a Given Rails Web Page</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-29T12:00:00-07:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>These tips may help those of you who are relatively new to Rails, or maybe even if you&rsquo;re not.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/05/29/finding-the-source-for-a-given-rails-web-page/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/16/considering-a-switch-to-the-atom-text-editor/">Considering a Switch to the Atom Text Editor?</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-03-16T12:00:00-07:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>You&rsquo;ve probably heard of <a href="http://atom.io/">Atom, Github&rsquo;s new text editor</a>. Read
these checklists to help you decide whether it&rsquo;s an editor worth switching to.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/16/considering-a-switch-to-the-atom-text-editor/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/01/simple-cellular-automata/">Simple Cellular Automata</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-01T12:00:00-08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I released a very simple cellular automata explorer. <a href="/cellauto/cellauto.html">Try it out here</a>.
See the <a href="https://github.com/moxley/cellauto">Github page</a> for more information.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/02/05/atom-elixir-setup/">Atom Editor Setup for Elixir</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/12/28/elixir-abstract-syntax/">Elixir Abstract Syntax</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/08/09/install-redis-on-macos-with-homebrew/">Install Redis on macOS With Homebrew</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/08/09/install-elixir-on-macos-using-asdf/">Install Elixir on macOS Using ASDF</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/27/low-level-activerecord/">Low-Level ActiveRecord</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/moxley">@moxley</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'moxley',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Moxley Stratton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'moxleystratton';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
